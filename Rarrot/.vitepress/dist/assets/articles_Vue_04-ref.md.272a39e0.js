import{_ as s,c as n,o as a,Q as l}from"./chunks/framework.7104966c.js";const b=JSON.parse('{"title":"ref","description":"","frontmatter":{},"headers":[],"relativePath":"articles/Vue/04-ref.md","filePath":"articles/Vue/04-ref.md","lastUpdated":1696146540000}'),p={name:"articles/Vue/04-ref.md"},o=l(`<h1 id="ref" tabindex="-1">ref <a class="header-anchor" href="#ref" aria-label="Permalink to &quot;ref&quot;">â€‹</a></h1><h2 id="ref-isref" tabindex="-1">refï¼ŒisRef <a class="header-anchor" href="#ref-isref" aria-label="Permalink to &quot;refï¼ŒisRef&quot;">â€‹</a></h2><p>åœ¨ Vue 3 ä¸­ï¼ŒrefÂ æ˜¯ä¸€ä¸ª<strong>å‡½æ•°</strong>ï¼Œç”¨äº<strong>åˆ›å»ºå“åº”å¼çš„æ•°æ®</strong>ã€‚å®ƒæ¥å—ä¸€ä¸ªå‚æ•°ä½œä¸ºåˆå§‹å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…è£…è¿‡çš„å“åº”å¼å¯¹è±¡ã€‚</p><p><strong>ref</strong>è·Ÿvue2çš„ä»¥ä¸‹è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªæ„æ€ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºå“åº”å¼æ•°æ®ï¼š</p><div class="language-Vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lang</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&#39;ts&#39;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">data</span><span style="color:#E1E4E8;">(){</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      age:</span><span style="color:#79B8FF;">18</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scoped</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lang</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&#39;ts&#39;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">default</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">data</span><span style="color:#24292E;">(){</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      age:</span><span style="color:#005CC5;">18</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">style</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scoped</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">style</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="ä½¿ç”¨refå»å†™åˆ™æ˜¯è¿™æ ·çš„" tabindex="-1">ä½¿ç”¨refå»å†™åˆ™æ˜¯è¿™æ ·çš„ï¼š <a class="header-anchor" href="#ä½¿ç”¨refå»å†™åˆ™æ˜¯è¿™æ ·çš„" aria-label="Permalink to &quot;ä½¿ç”¨refå»å†™åˆ™æ˜¯è¿™æ ·çš„ï¼š&quot;">â€‹</a></h3><div class="language-Vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    ref {{ rarrot }}</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@click</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;change&quot;</span><span style="color:#E1E4E8;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lang</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&#39;ts&#39;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ref, isRef } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rarrot</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">({ name: </span><span style="color:#9ECBFF;">&quot;rarrot&quot;</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">change</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// é€šè¿‡valueå»æ”¹å˜rarrotçš„å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">  rarrot.value.name</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;nihao&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ğŸš€&quot;</span><span style="color:#E1E4E8;">, rarrot)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// ç”¨äºæ£€æµ‹æ˜¯å¦ä¸ºå“åº”å¼å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">isRef</span><span style="color:#E1E4E8;">(rarrot))</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scoped</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    ref {{ rarrot }}</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;change&quot;</span><span style="color:#24292E;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lang</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&#39;ts&#39;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { ref, isRef } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rarrot</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">({ name: </span><span style="color:#032F62;">&quot;rarrot&quot;</span><span style="color:#24292E;"> })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">change</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// é€šè¿‡valueå»æ”¹å˜rarrotçš„å€¼</span></span>
<span class="line"><span style="color:#24292E;">  rarrot.value.name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;nihao&#39;</span></span>
<span class="line"><span style="color:#24292E;">  console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ğŸš€&quot;</span><span style="color:#24292E;">, rarrot)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ç”¨äºæ£€æµ‹æ˜¯å¦ä¸ºå“åº”å¼å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">  console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">isRef</span><span style="color:#24292E;">(rarrot))</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">style</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scoped</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">style</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308031812741.png" alt=""></p><h3 id="shallowref-triggerref" tabindex="-1">shallowRefï¼ŒtriggerRef <a class="header-anchor" href="#shallowref-triggerref" aria-label="Permalink to &quot;shallowRefï¼ŒtriggerRef&quot;">â€‹</a></h3><p>åœ¨ Vue 3 ä¸­ï¼ŒshallowRefÂ å’ŒÂ refÂ åŒºåˆ«å¦‚ä¸‹ï¼š</p><table><thead><tr><th></th><th>å“åº”å¼å¯¹è±¡çš„å¤„ç†æ–¹å¼</th><th>æ€§èƒ½å½±å“</th></tr></thead><tbody><tr><td><strong>ref</strong></td><td>ref åˆ›å»ºçš„å“åº”å¼å¯¹è±¡ä¼šå¯¹å…¶å€¼è¿›è¡Œ<strong>æ·±å±‚æ¬¡</strong>çš„å“åº”å¼è½¬æ¢ã€‚<br>å½“è®¿é—®æˆ–ä¿®æ”¹ ref è¿”å›çš„å¯¹è±¡æ—¶Vue ä¼šè‡ªåŠ¨è¿½è¸ªä¾èµ–<strong>å¹¶è¿›è¡Œè§†å›¾æ›´æ–°</strong>ã€‚</td><td>ç”±äº ref å¯¹å€¼è¿›è¡Œæ·±å±‚æ¬¡çš„å“åº”å¼è½¬æ¢ï¼Œå½“å€¼æ˜¯å¤æ‚å¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼Œä¼š<strong>æœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€</strong>å› ä¸º Vue éœ€è¦<strong>é€’å½’åœ°è¿½è¸ª</strong>å…¶æ‰€æœ‰å±æ€§çš„å˜åŒ–</td></tr><tr><td><strong>shallowRef</strong></td><td>shallowRef åˆ›å»ºçš„å“åº”å¼å¯¹è±¡åªå¯¹å…¶å€¼è¿›è¡Œ<strong>æµ…å±‚æ¬¡</strong>çš„å“åº”å¼è½¬æ¢ã€‚<br>å½“è®¿é—®æˆ–ä¿®æ”¹ shallowRef è¿”å›çš„å¯¹è±¡æ—¶ï¼ŒVue <strong>åªä¼šè¿½è¸ªè¯¥å¯¹è±¡æœ¬èº«çš„å˜åŒ–</strong>ï¼Œè€Œä¸ä¼šæ·±åº¦è¿½è¸ªå…¶å†…éƒ¨å±æ€§çš„å˜åŒ–ã€‚</td><td>ç”±äº shallowRef åªå¯¹å€¼è¿›è¡Œæµ…å±‚æ¬¡çš„å“åº”å¼è½¬æ¢ï¼Œå¯¹äºå¤æ‚å¯¹è±¡æˆ–æ•°ç»„ï¼Œå®ƒçš„<strong>æ€§èƒ½å¼€é”€è¾ƒä½</strong>ã€‚å› ä¸º Vue åªä¼š<strong>è¿½è¸ªå¯¹è±¡æœ¬èº«</strong>çš„å˜åŒ–ï¼Œè€Œä¸ä¼šæ·±åº¦è¿½è¸ªå…¶å†…éƒ¨å±æ€§çš„å˜åŒ–ã€‚</td></tr></tbody></table><h3 id="ç¤ºä¾‹" tabindex="-1">ç¤ºä¾‹ï¼š <a class="header-anchor" href="#ç¤ºä¾‹" aria-label="Permalink to &quot;ç¤ºä¾‹ï¼š&quot;">â€‹</a></h3><p>é€šè¿‡<code>triggerRef(rarrot2)</code>å’Œ<code>rarrot2.value={</code> <code>name:&#39;nihao2&#39;</code> <code>}</code>è¿™ä¸¤ç§æ–¹å¼ä¼šæ›´æ–°æ”¶é›†çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯è§†å›¾çš„æ›´æ–°ï¼Œçœ‹ä»£ç ï¼š</p><div class="language-Vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    shallowRef {{ rarrot2 }}</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@click</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;change&quot;</span><span style="color:#E1E4E8;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lang</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&#39;ts&#39;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { shallowRef, triggerRef } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vue&#39;</span></span>
<span class="line"><span style="color:#6A737D;">// ref shallowRef</span></span>
<span class="line"><span style="color:#6A737D;">// refæ·±å±‚æ¬¡   shallowRefæµ…å±‚æ¬¡çš„å“åº”</span></span>
<span class="line"><span style="color:#6A737D;">// shallowRefè·Ÿrefæ··å†™çš„è¯ï¼Œæ”¹å˜refï¼ŒshallowRefçš„é¡µé¢ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼ŒåŸå› æ˜¯è°ƒç”¨äº†triggerRef()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rarrot2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">({ name: </span><span style="color:#9ECBFF;">&#39;rarrot2&#39;</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">change</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// shallowRefä»¥ä¸‹è¿™ä¹ˆä¿®æ”¹ä¼šå¯¼è‡´å¯¹è±¡è¢«ä¿®æ”¹ï¼Œä½†æ˜¯é¡µé¢ä¸Šæ²¡æœ‰è¢«ä¿®æ”¹</span></span>
<span class="line"><span style="color:#E1E4E8;">  rarrot2.value.name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;nihao2&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">triggerRef</span><span style="color:#E1E4E8;">(rarrot2)</span><span style="color:#6A737D;">//triggerRefä¼šå¼ºåˆ¶æ›´æ–°æ”¶é›†çš„ä¾èµ–</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ğŸš€  rarrot2&quot;</span><span style="color:#E1E4E8;">, rarrot2)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// shallowRefç”¨ä»¥ä¸‹è¿™ç§æ–¹å¼å¯¹è±¡å’Œé¡µé¢ä¸Šéƒ½ä¼šè¢«ä¿®æ”¹</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// rarrot2.value={</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//   name:&#39;nihao2&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// }</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// console.log(&quot;ğŸš€  rarrot2&quot;, rarrot2)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scoped</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    shallowRef {{ rarrot2 }}</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;change&quot;</span><span style="color:#24292E;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lang</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&#39;ts&#39;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { shallowRef, triggerRef } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vue&#39;</span></span>
<span class="line"><span style="color:#6A737D;">// ref shallowRef</span></span>
<span class="line"><span style="color:#6A737D;">// refæ·±å±‚æ¬¡   shallowRefæµ…å±‚æ¬¡çš„å“åº”</span></span>
<span class="line"><span style="color:#6A737D;">// shallowRefè·Ÿrefæ··å†™çš„è¯ï¼Œæ”¹å˜refï¼ŒshallowRefçš„é¡µé¢ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼ŒåŸå› æ˜¯è°ƒç”¨äº†triggerRef()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rarrot2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">({ name: </span><span style="color:#032F62;">&#39;rarrot2&#39;</span><span style="color:#24292E;"> })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">change</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// shallowRefä»¥ä¸‹è¿™ä¹ˆä¿®æ”¹ä¼šå¯¼è‡´å¯¹è±¡è¢«ä¿®æ”¹ï¼Œä½†æ˜¯é¡µé¢ä¸Šæ²¡æœ‰è¢«ä¿®æ”¹</span></span>
<span class="line"><span style="color:#24292E;">  rarrot2.value.name </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;nihao2&#39;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">triggerRef</span><span style="color:#24292E;">(rarrot2)</span><span style="color:#6A737D;">//triggerRefä¼šå¼ºåˆ¶æ›´æ–°æ”¶é›†çš„ä¾èµ–</span></span>
<span class="line"><span style="color:#24292E;">  console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ğŸš€  rarrot2&quot;</span><span style="color:#24292E;">, rarrot2)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// shallowRefç”¨ä»¥ä¸‹è¿™ç§æ–¹å¼å¯¹è±¡å’Œé¡µé¢ä¸Šéƒ½ä¼šè¢«ä¿®æ”¹</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// rarrot2.value={</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//   name:&#39;nihao2&#39;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// }</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// console.log(&quot;ğŸš€  rarrot2&quot;, rarrot2)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">style</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scoped</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">style</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>ä¸‹å›¾å°†<code>triggerRef(rarrot2)</code>å’Œ<code>rarrot2.value={ name:&#39;nihao2&#39; }</code>éƒ½æ³¨é‡Šäº†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308032027751.png" alt=""></p><h2 id="customref" tabindex="-1">customRef <a class="header-anchor" href="#customref" aria-label="Permalink to &quot;customRef&quot;">â€‹</a></h2><p>åœ¨ Vue 3 ä¸­ï¼Œ<strong>customRef</strong>Â æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåˆ›å»ºè‡ªå®šä¹‰çš„å“åº”å¼æ•°æ®ã€‚å®ƒæ¥å—ä¸€ä¸ªå·¥å‚å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å·¥å‚å‡½æ•°è´Ÿè´£å®šä¹‰<strong>è‡ªå®šä¹‰</strong>çš„å“åº”å¼è¡Œä¸ºï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…è£…è¿‡çš„å“åº”å¼å¯¹è±¡ã€‚</p><p>é€šè¿‡ä½¿ç”¨Â customRefï¼Œä½ å¯ä»¥<strong>å®Œå…¨æ§åˆ¶å“åº”å¼æ•°æ®çš„ä¾èµ–è¿½è¸ªå’Œè§¦å‘æ›´æ–°çš„é€»è¾‘</strong>ã€‚è¿™å¯¹äºå®ç°ä¸€äº›ç‰¹å®šçš„å“åº”å¼è¡Œä¸ºæˆ–å¤„ç†å¤æ‚çš„æ•°æ®æƒ…å†µéå¸¸æœ‰ç”¨ã€‚çœ‹ä»£ç ï¼š</p><div class="language-Vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    customRef {{ rarrot3 }}</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@click</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;change&quot;</span><span style="color:#E1E4E8;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lang</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&#39;ts&#39;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { isRef, customRef } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">myRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> timer</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">any</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// track ç”¨äºè¿½è¸ªä¾èµ–ï¼Œtrigger ç”¨äºè§¦å‘æ›´æ–°</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">customRef</span><span style="color:#E1E4E8;">((</span><span style="color:#FFAB70;">track</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">trigger</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">track</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> value</span></span>
<span class="line"><span style="color:#E1E4E8;">      },</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">newVal</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">clearTimeout</span><span style="color:#E1E4E8;">(timer)</span></span>
<span class="line"><span style="color:#E1E4E8;">        timer</span><span style="color:#F97583;">=</span><span style="color:#B392F0;">setTimeout</span><span style="color:#E1E4E8;">(()</span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">          console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;è§¦å‘äº†&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">          value</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">newVal</span></span>
<span class="line"><span style="color:#E1E4E8;">          timer</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#B392F0;">trigger</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">        },</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">  })</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// å¯¹å…¶è¿›è¡Œèµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨customRefçš„get()æ–¹æ³•å»æ”¶é›†è¿™ä¸ªä¾èµ–</span></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rarrot3</span><span style="color:#F97583;">=</span><span style="color:#B392F0;">myRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#9ECBFF;">&#39;rarrot3&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">isRef</span><span style="color:#E1E4E8;">(rarrot3))</span><span style="color:#6A737D;">//true</span></span>
<span class="line"><span style="color:#E1E4E8;">console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(rarrot3)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">change</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">//.valueä¼šè°ƒç”¨customRefçš„set()æ–¹æ³•å»æ›´æ–°æ”¶é›†çš„è¿™ä¸ªä¾èµ–</span></span>
<span class="line"><span style="color:#E1E4E8;">  rarrot3.value</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;nihao3&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scoped</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    customRef {{ rarrot3 }}</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;change&quot;</span><span style="color:#24292E;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lang</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&#39;ts&#39;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { isRef, customRef } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">myRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> timer</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">any</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// track ç”¨äºè¿½è¸ªä¾èµ–ï¼Œtrigger ç”¨äºè§¦å‘æ›´æ–°</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">customRef</span><span style="color:#24292E;">((</span><span style="color:#E36209;">track</span><span style="color:#24292E;">, </span><span style="color:#E36209;">trigger</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">track</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> value</span></span>
<span class="line"><span style="color:#24292E;">      },</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(</span><span style="color:#E36209;">newVal</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">clearTimeout</span><span style="color:#24292E;">(timer)</span></span>
<span class="line"><span style="color:#24292E;">        timer</span><span style="color:#D73A49;">=</span><span style="color:#6F42C1;">setTimeout</span><span style="color:#24292E;">(()</span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">          console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;è§¦å‘äº†&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">          value</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">newVal</span></span>
<span class="line"><span style="color:#24292E;">          timer</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#6F42C1;">trigger</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">        },</span><span style="color:#005CC5;">500</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  })</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// å¯¹å…¶è¿›è¡Œèµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨customRefçš„get()æ–¹æ³•å»æ”¶é›†è¿™ä¸ªä¾èµ–</span></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rarrot3</span><span style="color:#D73A49;">=</span><span style="color:#6F42C1;">myRef</span><span style="color:#24292E;">&lt;</span><span style="color:#005CC5;">string</span><span style="color:#24292E;">&gt;(</span><span style="color:#032F62;">&#39;rarrot3&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">isRef</span><span style="color:#24292E;">(rarrot3))</span><span style="color:#6A737D;">//true</span></span>
<span class="line"><span style="color:#24292E;">console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(rarrot3)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">change</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">//.valueä¼šè°ƒç”¨customRefçš„set()æ–¹æ³•å»æ›´æ–°æ”¶é›†çš„è¿™ä¸ªä¾èµ–</span></span>
<span class="line"><span style="color:#24292E;">  rarrot3.value</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;nihao3&#39;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">style</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scoped</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">style</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308032041975.png" alt=""></p><p>ä»¥ä¸Šä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„é˜²æŠ–ï¼Œé˜²æ­¢ç”¨æˆ·è¿‡å¿«ç‚¹å‡»ï¼Œå¯¼è‡´å¡é¡¿ï¼Œé˜²æŠ–ä¼šä½¿å¾—ç”¨æˆ·åœ¨è¿‡å¿«ç‚¹å‡»æ—¶ä¸ä¼šè§¦å‘å®šæ—¶å™¨ï¼Œåœ¨åœæ­¢ç‚¹å‡»åæ‰è§¦å‘ï¼Œä»¥ä¸‹ä¸ºä»£ç è§£é‡Šï¼š</p><p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯åœ¨ä¿®æ”¹Â <code>rarrot3</code>Â çš„å€¼åï¼Œå»¶è¿Ÿ500æ¯«ç§’æ‰è§¦å‘æ›´æ–°ã€‚è¿™æ˜¯é€šè¿‡åœ¨Â <code>set()</code>Â æ–¹æ³•ä¸­ä½¿ç”¨Â <code>setTimeout()</code>Â æ¥å®ç°çš„ã€‚åœ¨Â <code>set()</code>Â æ–¹æ³•ä¸­ï¼Œæ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªæ–°çš„å®šæ—¶å™¨æ¥å»¶è¿Ÿæ›´æ–°ã€‚å½“å®šæ—¶å™¨è§¦å‘æ—¶ï¼Œå°±å°†æ–°çš„å€¼èµ‹ç»™Â <code>value</code>ï¼Œå¹¶é€šè¿‡è°ƒç”¨Â <code>trigger()</code>Â æ–¹æ³•æ¥è§¦å‘æ›´æ–°ã€‚</p><h2 id="ref-å°å¦™æ‹›" tabindex="-1">ref å°å¦™æ‹› <a class="header-anchor" href="#ref-å°å¦™æ‹›" aria-label="Permalink to &quot;ref å°å¦™æ‹›&quot;">â€‹</a></h2><p>æˆ‘ä»¬åœ¨ä½¿ç”¨refåï¼Œæƒ³è¦æ‰“å°è¿”å›çš„å“åº”å¼å¯¹è±¡ï¼Œä½†æ˜¯ç»™äº†ä¸€å †å±æ€§ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308032102901.png" alt=""></p><p>æ‰€ä»¥å¯ä»¥è¿›è¡Œä»¥ä¸‹è®¾ç½®ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308032057850.png" alt=""></p><p>è®¾ç½®ä¹‹åæ‰“å°çš„æ•ˆæœå°±å˜å¾—å¾ˆç®€æ´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308032103697.png" alt=""></p><h2 id="ç”¨refæ“ä½œdom" tabindex="-1">ç”¨refæ“ä½œDOM <a class="header-anchor" href="#ç”¨refæ“ä½œdom" aria-label="Permalink to &quot;ç”¨refæ“ä½œDOM&quot;">â€‹</a></h2><p>çœ‹ä»£ç ï¼š</p><div class="language-Vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">Vue</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;domm&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    æˆ‘æ˜¯domm</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;/</span><span style="color:#85E89D;">div</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">@click</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;change&quot;</span><span style="color:#E1E4E8;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#85E89D;">button</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">setup</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lang</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&#39;ts&#39;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { ref } </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">domm</span><span style="color:#F97583;">=</span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">HTMLDivElement</span><span style="color:#E1E4E8;">&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">change</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> () </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// ?. æ˜¯å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional Chaining Operatorï¼‰</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// åœ¨è®¿é—®å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•ä¹‹å‰ï¼Œéœ€è¦å…ˆç¡®ä¿å¯¹è±¡æœ¬èº«ä¸ä¸º null æˆ– undefined</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// å¦‚æœå¯¹è±¡ä¸º null æˆ– undefinedï¼Œç›´æ¥è®¿é—®å…¶å±æ€§æˆ–æ–¹æ³•å°†ä¼šå¯¼è‡´ TypeError é”™è¯¯ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">  console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(domm.value?.innerText)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">scoped</span><span style="color:#E1E4E8;">&gt;&lt;/</span><span style="color:#85E89D;">style</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">div</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;domm&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    æˆ‘æ˜¯domm</span></span>
<span class="line"><span style="color:#24292E;">  &lt;/</span><span style="color:#22863A;">div</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">button</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">@click</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;change&quot;</span><span style="color:#24292E;">&gt;ç‚¹å‡»æˆ‘&lt;/</span><span style="color:#22863A;">button</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">setup</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lang</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&#39;ts&#39;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { ref } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">domm</span><span style="color:#D73A49;">=</span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">HTMLDivElement</span><span style="color:#24292E;">&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">change</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> () </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ?. æ˜¯å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆOptional Chaining Operatorï¼‰</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// åœ¨è®¿é—®å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•ä¹‹å‰ï¼Œéœ€è¦å…ˆç¡®ä¿å¯¹è±¡æœ¬èº«ä¸ä¸º null æˆ– undefined</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// å¦‚æœå¯¹è±¡ä¸º null æˆ– undefinedï¼Œç›´æ¥è®¿é—®å…¶å±æ€§æˆ–æ–¹æ³•å°†ä¼šå¯¼è‡´ TypeError é”™è¯¯ã€‚</span></span>
<span class="line"><span style="color:#24292E;">  console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(domm.value?.innerText)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">style</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">scoped</span><span style="color:#24292E;">&gt;&lt;/</span><span style="color:#22863A;">style</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/hr1201/img@main/imgs/202308032111261.png" alt=""></p><h2 id="ä»æºç è§£é‡Šrefå’Œshallowrefçš„åŒºåˆ«" tabindex="-1">ä»æºç è§£é‡Šrefå’ŒshallowRefçš„åŒºåˆ« <a class="header-anchor" href="#ä»æºç è§£é‡Šrefå’Œshallowrefçš„åŒºåˆ«" aria-label="Permalink to &quot;ä»æºç è§£é‡Šrefå’ŒshallowRefçš„åŒºåˆ«&quot;">â€‹</a></h2><h3 id="refçš„åˆ›å»ºè¿‡ç¨‹" tabindex="-1">refçš„åˆ›å»ºè¿‡ç¨‹ <a class="header-anchor" href="#refçš„åˆ›å»ºè¿‡ç¨‹" aria-label="Permalink to &quot;refçš„åˆ›å»ºè¿‡ç¨‹&quot;">â€‹</a></h3><p>å…ˆè¯´ä¸€ä¸‹refçš„åˆ›å»ºè¿‡ç¨‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">Â * è·å–ä¸€ä¸ªå†…éƒ¨å€¼å¹¶è¿”å›ä¸€ä¸ªreactive(å“åº”)å’Œmutable(å¯å˜)çš„ ref å¯¹è±¡</span></span>
<span class="line"><span style="color:#6A737D;">Â * æœ‰ä¸€ä¸ªæŒ‡å‘å†…éƒ¨å€¼çš„å±æ€§\`.value\`</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E1E4E8;">value</span><span style="color:#6A737D;"> - The object to wrap in the ref.</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#F97583;">@see</span><span style="color:#6A737D;"> </span><span style="color:#B392F0;">{</span><span style="color:#F97583;">@link</span><span style="color:#B392F0;"> </span><span style="color:#E1E4E8;">https://vuejs.org/api/reactivity-core.html#ref</span><span style="color:#B392F0;">}</span></span>
<span class="line"><span style="color:#6A737D;">Â */</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ref</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">UnwrapRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt;&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">&gt;()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">undefined</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ref</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">unknown</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createRef</span><span style="color:#E1E4E8;">(value, </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">Â * è·å–ä¸€ä¸ªå†…éƒ¨å€¼å¹¶è¿”å›ä¸€ä¸ªreactive(å“åº”)å’Œmutable(å¯å˜)çš„ ref å¯¹è±¡</span></span>
<span class="line"><span style="color:#6A737D;">Â * æœ‰ä¸€ä¸ªæŒ‡å‘å†…éƒ¨å€¼çš„å±æ€§\`.value\`</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#24292E;">value</span><span style="color:#6A737D;"> - The object to wrap in the ref.</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#D73A49;">@see</span><span style="color:#6A737D;"> </span><span style="color:#6F42C1;">{</span><span style="color:#D73A49;">@link</span><span style="color:#6F42C1;"> </span><span style="color:#24292E;">https://vuejs.org/api/reactivity-core.html#ref</span><span style="color:#6F42C1;">}</span></span>
<span class="line"><span style="color:#6A737D;">Â */</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ref</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">UnwrapRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">&gt;()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ref</span><span style="color:#24292E;">(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createRef</span><span style="color:#24292E;">(value, </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ä»¥ä¸Šè¿ç”¨å‡½æ•°çš„é‡è½½ï¼Œä»¥é€‚åº”å¤šç§ä¼ å…¥çš„ç±»å‹ã€‚</p><p>ä¸Šé¢ä»£ç ä¸­è°ƒç”¨<code>createRef(value, false)</code>ï¼Œvalueä¸ºç”¨æˆ·ä¼ å…¥çš„å€¼ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createRef</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">rawValue</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">unknown</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">shallow</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">isRef</span><span style="color:#E1E4E8;">(rawValue)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> rawValue</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  }</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RefImpl</span><span style="color:#E1E4E8;">(rawValue, shallow)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createRef</span><span style="color:#24292E;">(</span><span style="color:#E36209;">rawValue</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">, </span><span style="color:#E36209;">shallow</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">isRef</span><span style="color:#24292E;">(rawValue)) {</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> rawValue</span></span>
<span class="line"><span style="color:#24292E;">Â  }</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RefImpl</span><span style="color:#24292E;">(rawValue, shallow)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å…ˆåˆ¤æ–­äº†rawValueæ˜¯å¦ä¸ºå“åº”å¼å¯¹è±¡ï¼Œæ˜¯å°±ç›´æ¥è¿”å›rawValueï¼Œå¦åˆ™è°ƒç”¨<code>RefImpl(rawValue, shallow)</code>åˆ›å»ºrefå¯¹è±¡ã€‚</p><p>è®°ä½ï¼Œè¿™é‡Œçš„<code>shallow</code>ä¼ å…¥ä¸º<strong>false</strong>ã€‚</p><p>ä¸Šé¢ä»£ç ä¸­ä¸æ˜¯refå¯¹è±¡å°±è°ƒç”¨äº†<code>RefImpl(rawValue, shallow)</code>ï¼Œè¿™é‡Œæ˜¯å°†<code>rawValue</code>å’Œ<code>shallow</code>ä¼ å…¥åˆ°æ„é€ æ–¹æ³•ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RefImpl</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">_value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">private</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">_rawValue</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">dep</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dep</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">undefined</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">readonly</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">__v_isRef</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">constructor</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">readonly</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">__v_isShallow</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._rawValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> __v_isShallow </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> value </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toRaw</span><span style="color:#E1E4E8;">(value)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._value </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> __v_isShallow </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> value </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toReactive</span><span style="color:#E1E4E8;">(value)</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">value</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">trackRefValue</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._value</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#F97583;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">value</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">newVal</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#6A737D;">// åˆ¤æ–­æ˜¯å¦ä¸ºæµ…å“åº”å¼å¯¹è±¡ï¼ŒshallowRefä¼ å…¥çš„__v_isShallowä¸ºtrueï¼Œ</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#6A737D;">// isShallow(newVal)åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯å¦ä¸ºæµ…å±‚å“åº”å¼ï¼Œ</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#6A737D;">// isReadonly(newVal)åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯å¦ä¸ºåªè¯»å“åº”å¼å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#6A737D;">// åªè¦ä¸‰ä¸ªæ¡ä»¶ä¸­æœ‰ä¸€ä¸ªä¸ºtrueï¼ŒuseDirectValueå°±ä¸ºtrue</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">useDirectValue</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.__v_isShallow </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">isShallow</span><span style="color:#E1E4E8;">(newVal) </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">isReadonly</span><span style="color:#E1E4E8;">(newVal)</span></span>
<span class="line"><span style="color:#E1E4E8;"> Â  Â  Â  </span><span style="color:#6A737D;">// å½“useDirectValueä¸ºfalseï¼Œä¹Ÿå°±æ˜¯ä¸ºæ·±å±‚æ¬¡å“åº”å¯¹è±¡æ—¶ï¼Œå°±å°†å…¶è½¬æ¢ä¸ºåŸå§‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  newVal </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> useDirectValue </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> newVal </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toRaw</span><span style="color:#E1E4E8;">(newVal)</span></span>
<span class="line"><span style="color:#E1E4E8;"> Â  Â  Â  </span><span style="color:#6A737D;">// è¿™é‡Œæ¯”è¾ƒåŸå§‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">hasChanged</span><span style="color:#E1E4E8;">(newVal, </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._rawValue)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  Â  </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._rawValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> newVal</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  Â  </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._value </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> useDirectValue </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> newVal </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toReactive</span><span style="color:#E1E4E8;">(newVal)</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  Â  </span><span style="color:#B392F0;">triggerRefValue</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">, newVal)</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  }</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RefImpl</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt; {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#E36209;">_value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">private</span><span style="color:#24292E;"> </span><span style="color:#E36209;">_rawValue</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#E36209;">dep</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dep</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">readonly</span><span style="color:#24292E;"> </span><span style="color:#E36209;">__v_isRef</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">constructor</span><span style="color:#24292E;">(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">readonly</span><span style="color:#24292E;"> </span><span style="color:#E36209;">__v_isShallow</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._rawValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> __v_isShallow </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> value </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toRaw</span><span style="color:#24292E;">(value)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> __v_isShallow </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> value </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toReactive</span><span style="color:#24292E;">(value)</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">get</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">value</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">trackRefValue</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._value</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#D73A49;">set</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">value</span><span style="color:#24292E;">(</span><span style="color:#E36209;">newVal</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#6A737D;">// åˆ¤æ–­æ˜¯å¦ä¸ºæµ…å“åº”å¼å¯¹è±¡ï¼ŒshallowRefä¼ å…¥çš„__v_isShallowä¸ºtrueï¼Œ</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#6A737D;">// isShallow(newVal)åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯å¦ä¸ºæµ…å±‚å“åº”å¼ï¼Œ</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#6A737D;">// isReadonly(newVal)åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯å¦ä¸ºåªè¯»å“åº”å¼å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#6A737D;">// åªè¦ä¸‰ä¸ªæ¡ä»¶ä¸­æœ‰ä¸€ä¸ªä¸ºtrueï¼ŒuseDirectValueå°±ä¸ºtrue</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">useDirectValue</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">.__v_isShallow </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">isShallow</span><span style="color:#24292E;">(newVal) </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">isReadonly</span><span style="color:#24292E;">(newVal)</span></span>
<span class="line"><span style="color:#24292E;"> Â  Â  Â  </span><span style="color:#6A737D;">// å½“useDirectValueä¸ºfalseï¼Œä¹Ÿå°±æ˜¯ä¸ºæ·±å±‚æ¬¡å“åº”å¯¹è±¡æ—¶ï¼Œå°±å°†å…¶è½¬æ¢ä¸ºåŸå§‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  newVal </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> useDirectValue </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> newVal </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toRaw</span><span style="color:#24292E;">(newVal)</span></span>
<span class="line"><span style="color:#24292E;"> Â  Â  Â  </span><span style="color:#6A737D;">// è¿™é‡Œæ¯”è¾ƒåŸå§‹å¯¹è±¡</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">hasChanged</span><span style="color:#24292E;">(newVal, </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._rawValue)) {</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  Â  </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._rawValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> newVal</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  Â  </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> useDirectValue </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> newVal </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toReactive</span><span style="color:#24292E;">(newVal)</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  Â  </span><span style="color:#6F42C1;">triggerRefValue</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">, newVal)</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  }</span></span>
<span class="line"><span style="color:#24292E;">Â  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>ä»¥ä¸Šä»£ç å…ˆå®šä¹‰ç§æœ‰çš„<code>_value</code>å’Œ<code>_rawValue</code>ï¼Œè¿™ä¸ªç±»ä¸­çš„æ„é€ æ–¹æ³•çš„å‚æ•°<code>__v_isShallow</code>å‰é¢ä¼ å…¥ä¸º<strong>false</strong>ï¼Œæ‰€ä»¥åˆä¼šè°ƒç”¨<code>toReactive(value)</code>ã€‚</p><p><code>toReactive(value)</code>çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toReactive</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> &lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">unknown</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#B392F0;">isObject</span><span style="color:#E1E4E8;">(value) </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">reactive</span><span style="color:#E1E4E8;">(value) </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> value</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toReactive</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> &lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#6F42C1;">isObject</span><span style="color:#24292E;">(value) </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">reactive</span><span style="color:#24292E;">(value) </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> value</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ä»¥ä¸Šè¿™æ®µä»£ç å°±æ˜¯è¯´åˆ¤æ–­<code>value</code>æ˜¯ä¸æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œæ˜¯çš„è¯å°±ä¼šè°ƒç”¨<code>reactive(value)</code>ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨æ¥<strong>å°†æ™®é€šå¯¹è±¡è½¬æ¢ä¸ºå“åº”å¼å¯¹è±¡</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒVue å¯ä»¥æ£€æµ‹åˆ°è¿™äº›å˜åŒ–å¹¶è‡ªåŠ¨æ›´æ–°ç›¸å…³çš„è§†å›¾ã€‚</p><h3 id="shallowrefçš„åˆ›å»ºè¿‡ç¨‹" tabindex="-1">shallowRefçš„åˆ›å»ºè¿‡ç¨‹ <a class="header-anchor" href="#shallowrefçš„åˆ›å»ºè¿‡ç¨‹" aria-label="Permalink to &quot;shallowRefçš„åˆ›å»ºè¿‡ç¨‹&quot;">â€‹</a></h3><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">declare</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ShallowRefMarker</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">unique</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">symbol</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ShallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ref</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;"> { [ShallowRefMarker]</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">Â * Shallow version of </span><span style="color:#B392F0;">{</span><span style="color:#F97583;">@link</span><span style="color:#B392F0;"> </span><span style="color:#E1E4E8;">ref()</span><span style="color:#B392F0;">}</span><span style="color:#6A737D;">.</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#F97583;">@example</span></span>
<span class="line"><span style="color:#6A737D;">Â * \`\`\`js</span></span>
<span class="line"><span style="color:#6A737D;">Â * const state = shallowRef({ count: 1 })</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * // è¿™ä¸ä¼šè§¦å‘å“åº”å¼ç³»ç»Ÿçš„å˜åŒ–</span></span>
<span class="line"><span style="color:#6A737D;">Â * state.value.count = 2</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * // è¿™ä¼šè§¦å‘å“åº”å¼ç³»ç»Ÿçš„å˜åŒ–</span></span>
<span class="line"><span style="color:#6A737D;">Â * state.value = { count: 2 }</span></span>
<span class="line"><span style="color:#6A737D;">Â * \`\`\`</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#F97583;">@param</span><span style="color:#6A737D;"> </span><span style="color:#E1E4E8;">value</span><span style="color:#6A737D;"> - The &quot;inner value&quot; for the shallow ref.</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#F97583;">@see</span><span style="color:#6A737D;"> </span><span style="color:#B392F0;">{</span><span style="color:#F97583;">@link</span><span style="color:#B392F0;"> </span><span style="color:#E1E4E8;">https://vuejs.org/api/reactivity-advanced.html#shallowref</span><span style="color:#B392F0;">}</span></span>
<span class="line"><span style="color:#6A737D;">Â */</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">object</span><span style="color:#E1E4E8;">&gt;(</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ref</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ShallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt;(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ShallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">&gt;()</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ShallowRef</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">T</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">undefined</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">?:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">unknown</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">createRef</span><span style="color:#E1E4E8;">(value, </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">declare</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ShallowRefMarker</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">unique</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">symbol</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ShallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">&gt; </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ref</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt; </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;"> { [ShallowRefMarker]</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> }</span></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">Â * Shallow version of </span><span style="color:#6F42C1;">{</span><span style="color:#D73A49;">@link</span><span style="color:#6F42C1;"> </span><span style="color:#24292E;">ref()</span><span style="color:#6F42C1;">}</span><span style="color:#6A737D;">.</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#D73A49;">@example</span></span>
<span class="line"><span style="color:#6A737D;">Â * \`\`\`js</span></span>
<span class="line"><span style="color:#6A737D;">Â * const state = shallowRef({ count: 1 })</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * // è¿™ä¸ä¼šè§¦å‘å“åº”å¼ç³»ç»Ÿçš„å˜åŒ–</span></span>
<span class="line"><span style="color:#6A737D;">Â * state.value.count = 2</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * // è¿™ä¼šè§¦å‘å“åº”å¼ç³»ç»Ÿçš„å˜åŒ–</span></span>
<span class="line"><span style="color:#6A737D;">Â * state.value = { count: 2 }</span></span>
<span class="line"><span style="color:#6A737D;">Â * \`\`\`</span></span>
<span class="line"><span style="color:#6A737D;">Â *</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#D73A49;">@param</span><span style="color:#6A737D;"> </span><span style="color:#24292E;">value</span><span style="color:#6A737D;"> - The &quot;inner value&quot; for the shallow ref.</span></span>
<span class="line"><span style="color:#6A737D;">Â * </span><span style="color:#D73A49;">@see</span><span style="color:#6A737D;"> </span><span style="color:#6F42C1;">{</span><span style="color:#D73A49;">@link</span><span style="color:#6F42C1;"> </span><span style="color:#24292E;">https://vuejs.org/api/reactivity-advanced.html#shallowref</span><span style="color:#6F42C1;">}</span></span>
<span class="line"><span style="color:#6A737D;">Â */</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">object</span><span style="color:#24292E;">&gt;(</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span></span>
<span class="line"><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ref</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ShallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ShallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">&gt;()</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ShallowRef</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">createRef</span><span style="color:#24292E;">(value, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>è¿™ä¸€æ®µè·Ÿä¸Šé¢refçš„åŒç†äº†ï¼Œåªä¸è¿‡è¿™é‡Œä¼ å…¥åˆ°<code>createRef</code>çš„shallowä¸º<strong>trueã€‚</strong></p><p>å› ä¸ºä¼ å…¥ä¸º<strong>true</strong>ï¼Œæ‰€ä»¥åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œå°±ä¼šç›´æ¥è¿”å›valueå¹¶èµ‹å€¼ç»™RefImplç±»çš„_valueç§æœ‰å±æ€§ï¼Œ</p><ol><li>åœ¨è¯»å–æ—¶ä¼šè°ƒç”¨<code>get()</code>æ–¹æ³•ï¼Œé‡Œé¢çš„<code>trackRefValue(this)</code>ä¼šæ”¶é›†ä¾èµ–</li><li>è®¾ç½®å€¼æ—¶ä¼šè°ƒç”¨<code>set(newVal)</code>æ–¹æ³•ï¼Œè¿™é‡Œçš„<code>set(newVal)</code>ä¼šå…ˆåˆ¤æ–­å€¼æ˜¯å¦æ”¹å˜ï¼Œæœ‰æ”¹å˜çš„è¯å°†æ–°å€¼ä¼ é€’ç»™Â _rawValue</li><li>å¦‚æœä¹‹å‰å·²ç»ä½¿ç”¨äº†æµ…å±‚æ¨¡å¼æˆ–è€…æ–°å€¼æ˜¯æµ…å±‚å“åº”å¼æˆ–åªè¯»å“åº”å¼ï¼Œåˆ™ç›´æ¥ä½¿ç”¨æ–°å€¼ï¼Œå¦åˆ™ä½¿ç”¨Â <code>toReactive(newVal)</code>Â å‡½æ•°å°†æ–°å€¼è½¬æ¢ä¸ºå“åº”å¼å¯¹è±¡ã€‚</li><li>æœ€åå†è°ƒç”¨Â <code>triggerRefValue(this,newValue)</code>Â å‡½æ•°ï¼Œè§¦å‘å¯¹è¯¥Â customRefÂ å¯¹è±¡çš„ä¾èµ–æ›´æ–°ã€‚</li></ol><p>ä¹‹æ‰€ä»¥refè·ŸshallowRefåŒæ—¶ä½¿ç”¨ï¼Œéƒ½ä¼šè¿›è¡Œè§†å›¾æ›´æ–°ï¼Œå› ä¸ºrefä¼šè°ƒç”¨<code>triggerRefValue(this, newVal)</code>ï¼Œå°±ä¼šæŠŠæ”¶é›†çš„ä¾èµ–éƒ½è¿›è¡Œæ›´æ–°ã€‚</p><h2 id="ç–‘é—®" tabindex="-1">ç–‘é—® <a class="header-anchor" href="#ç–‘é—®" aria-label="Permalink to &quot;ç–‘é—®&quot;">â€‹</a></h2><ol><li>ä¸ºä»€ä¹ˆæ·±å±‚æ¬¡å“åº”å¼å¯¹è±¡è¦ä½¿ç”¨toRaw()è½¬æ¢ä¸ºåŸå§‹å¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼Œè€Œæµ…å±‚æ¬¡å“åº”å¼å¯¹è±¡ä¸ç”¨è½¬æ¢ï¼Ÿ</li></ol><p>çœ‹ä¸‹æ–¹ã€‚</p><ol start="2"><li>è¿˜æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯ï¼Œä»¥ä¸‹ä¼šæ›´æ–°è§†å›¾çš„å˜åŒ–æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ</li></ol><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rarrot2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">({ name: </span><span style="color:#9ECBFF;">&#39;rarrot2&#39;</span><span style="color:#E1E4E8;"> })</span></span>
<span class="line"><span style="color:#E1E4E8;">rarrot2.value</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{ name:</span><span style="color:#9ECBFF;">&#39;nihao2&#39;</span><span style="color:#E1E4E8;"> }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rarrot2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">({ name: </span><span style="color:#032F62;">&#39;rarrot2&#39;</span><span style="color:#24292E;"> })</span></span>
<span class="line"><span style="color:#24292E;">rarrot2.value</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{ name:</span><span style="color:#032F62;">&#39;nihao2&#39;</span><span style="color:#24292E;"> }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è€Œä»¥ä¸‹è¿™æ ·åˆä¸ä¼šæ›´æ–°è§†å›¾</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">rarrot2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">shallowRef</span><span style="color:#E1E4E8;">({ name: </span><span style="color:#9ECBFF;">&#39;rarrot2&#39;</span><span style="color:#E1E4E8;"> }) </span></span>
<span class="line"><span style="color:#E1E4E8;">rarrot2.value.name</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;nihao2&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">rarrot2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">shallowRef</span><span style="color:#24292E;">({ name: </span><span style="color:#032F62;">&#39;rarrot2&#39;</span><span style="color:#24292E;"> }) </span></span>
<span class="line"><span style="color:#24292E;">rarrot2.value.name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;nihao2&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="è§£ç­”" tabindex="-1">è§£ç­” <a class="header-anchor" href="#è§£ç­”" aria-label="Permalink to &quot;è§£ç­”&quot;">â€‹</a></h3><p>å…¶å®ä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆéƒ½åœ¨<code>set()</code>æ–¹æ³•é‡Œï¼Œçœ‹æºä»£ç ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">set </span><span style="color:#B392F0;">value</span><span style="color:#E1E4E8;">(newVal) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  Â Â </span><span style="color:#F97583;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">// å½“useDirectValueä¸ºtrueï¼Œä¹Ÿå°±æ˜¯ä¸ºæ·±å±‚æ¬¡å“åº”å¯¹è±¡æ—¶ï¼Œå°±å°†å…¶è½¬æ¢ä¸ºåŸå§‹å¯¹è±¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  newVal </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> useDirectValue </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> newVal </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toRaw</span><span style="color:#E1E4E8;">(newVal)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">hasChanged</span><span style="color:#E1E4E8;">(newVal, </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._rawValue)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  Â  </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._rawValue </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> newVal</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  Â  </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">._value </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> useDirectValue </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> newVal </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">toReactive</span><span style="color:#E1E4E8;">(newVal)</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  Â  </span><span style="color:#B392F0;">triggerRefValue</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">, newVal)</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  Â  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">set </span><span style="color:#6F42C1;">value</span><span style="color:#24292E;">(newVal) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  Â Â </span><span style="color:#D73A49;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// å½“useDirectValueä¸ºtrueï¼Œä¹Ÿå°±æ˜¯ä¸ºæ·±å±‚æ¬¡å“åº”å¯¹è±¡æ—¶ï¼Œå°±å°†å…¶è½¬æ¢ä¸ºåŸå§‹å¯¹è±¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Â  Â  newVal </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> useDirectValue </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> newVal </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toRaw</span><span style="color:#24292E;">(newVal)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Â  Â  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">hasChanged</span><span style="color:#24292E;">(newVal, </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._rawValue)) {</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  Â  </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._rawValue </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> newVal</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  Â  </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">._value </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> useDirectValue </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> newVal </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">toReactive</span><span style="color:#24292E;">(newVal)</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  Â  </span><span style="color:#6F42C1;">triggerRefValue</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">, newVal)</span></span>
<span class="line"><span style="color:#24292E;">Â  Â  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">hasChanged</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">value</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">oldValue</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">any</span><span style="color:#E1E4E8;">)</span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">boolean</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">Â  </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">Object.</span><span style="color:#B392F0;">is</span><span style="color:#E1E4E8;">(value, oldValue)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">hasChanged</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">, </span><span style="color:#E36209;">oldValue</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">any</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=&gt;</span></span>
<span class="line"><span style="color:#24292E;">Â  </span><span style="color:#D73A49;">!</span><span style="color:#24292E;">Object.</span><span style="color:#6F42C1;">is</span><span style="color:#24292E;">(value, oldValue)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>â‘  è¿™é‡Œæ·±å±‚æ¬¡å¯¹è±¡éœ€è¦ç”¨toRaw()<strong>è½¬æ¢ä¸ºåŸå§‹å¯¹è±¡</strong>è¿›è¡Œæ¯”è¾ƒï¼ŒåŸå› ä¸ºç›´æ¥æ¯”è¾ƒçš„è¯æ¯”è¾ƒçš„æ˜¯å¼•ç”¨ï¼Œé‚£å°±æ²¡æœ‰å˜åŒ–ï¼Œéœ€è¦æ¯”è¾ƒçš„æ˜¯å±æ€§å€¼ã€‚</p><p>â‘¡ è¿™é‡Œç›´æ¥æ¯”è¾ƒæµ…å±‚æ¬¡å“åº”å¼å¯¹è±¡çš„è¯ï¼Œæ¯”è¾ƒçš„æ˜¯å¼•ç”¨ï¼Œæ–°å€¼çš„å¼•ç”¨å’Œæ—§å€¼çš„å¼•ç”¨ï¼Œåœ¨åªæ”¹å˜å±æ€§çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¸€æ ·çš„ã€‚</p><p>ä½†æ˜¯å¦‚æœé€šè¿‡rarrot2.value={ name:&#39;nihao2&#39; }ï¼Œåˆ™æ”¹å˜äº†å¼•ç”¨ï¼Œæ‰€ä»¥å°±ä¼šè°ƒç”¨ifé‡Œé¢çš„æ¡ä»¶äº†ã€‚</p>`,69),e=[o];function r(t,c,E,y,i,u){return a(),n("div",null,e)}const d=s(p,[["render",r]]);export{b as __pageData,d as default};
