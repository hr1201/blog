!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).AlgoliaAnalytics={})}(this,function(e){"use strict";function n(){"function"!=typeof Object.assign&&(Object.assign=function(e,n){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),o=1;o<arguments.length;o++){var r=t[o];if(null!=r)for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(i[s]=r[s])}return i})}function d(e,n){var t={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)n.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(t[o[i]]=e[o[i]]);return t}function o(e){return e.reduce(function(e,n){var t=e.events,e=e.additionalParams;return"index"in n?{additionalParams:e,events:t.concat([n])}:{events:t,additionalParams:n}},{events:[],additionalParams:void 0})}function t(){try{return Boolean(navigator.cookieEnabled)}catch(e){return}}function f(e){return void 0===e}function s(e){return"number"==typeof e}function r(e){return"function"==typeof e}function i(h){return function(e,n){var i=this;if(!this._userHasOptedOut){if(!(!f(this._apiKey)&&!f(this._appId)||(null==(l=null==n?void 0:n.headers)?void 0:l["X-Algolia-Application-Id"])&&(null==(l=null==n?void 0:n.headers)?void 0:l["X-Algolia-API-Key"])))throw new Error("Before calling any methods on the analytics, you first need to call the 'init' function with appId and apiKey parameters or provide custom credentials in additional parameters.");!this._userToken&&this._anonymousUserToken&&this.setAnonymousUserToken(!0);var t,o,r,s,a,u,c,l=e.map(function(e){var n=e.filters,t=d(e,["filters"]),e=Object.assign(Object.assign({},t),{userToken:null!=(t=null==e?void 0:e.userToken)?t:i._userToken});return f(n)||(e.filters=n.map(encodeURIComponent)),e});return e=h,t=this._ua,o=this._endpointOrigin,l=l,r=this._appId,s=this._apiKey,n=null==n?void 0:n.headers,a=(n=void 0===n?{}:n)["X-Algolia-Application-Id"],u=n["X-Algolia-API-Key"],n=d(n,["X-Algolia-Application-Id","X-Algolia-API-Key"]),c=Object.assign({"X-Algolia-Application-Id":null!=a?a:r,"X-Algolia-API-Key":null!=u?u:s,"X-Algolia-Agent":encodeURIComponent(t.join("; "))},n),a=Object.keys(c).map(function(e){return e+"="+c[e]}).join("&"),e(o+"/1/events?"+a,{events:l})}}}var a="2.8.1",u=["insights-js ("+a+")","insights-js-browser-umd ("+a+")"];function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)})}function l(e,n,t){var i=new Date,t=(i.setTime(i.getTime()+t),"expires="+i.toUTCString());document.cookie=e+"="+n+";"+t+";path=/"}function h(e){for(var n=e+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var o=t[i];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return""}var v="_ALGOLIA",p=2592e6;n();var g,b,y,k,O=["de","us"];function m(e){if(!f((e=void 0===e?{}:e).region)&&-1===O.indexOf(e.region))throw new Error("optional region is incorrect, please provide either one of: "+O.join(", ")+".");if(!(f(e.cookieDuration)||s(e.cookieDuration)&&isFinite(e.cookieDuration)&&Math.floor(e.cookieDuration)===e.cookieDuration))throw new Error("optional cookieDuration is incorrect, expected an integer.");var n=this,t=e,i={_userHasOptedOut:!!e.userHasOptedOut,_region:e.region,_host:e.host,_anonymousUserToken:null==(i=e.anonymousUserToken)||i,_useCookie:null!=(i=e.useCookie)&&i,_cookieDuration:e.cookieDuration||6*p},o=t.partial,r=d(t,["partial"]);o||Object.assign(n,i),Object.assign(n,Object.keys(r).reduce(function(e,n){return Object.assign(Object.assign({},e),((e={})["_"+n]=r[n],e))},{})),this._endpointOrigin=this._host||(this._region?"https://insights."+this._region+".algolia.io":"https://insights.algolia.io"),this._ua=[].concat(u),e.userToken?this.setUserToken(e.userToken):this._userToken||this._userHasOptedOut||!this._useCookie||this.setAnonymousUserToken()}function T(n,e){return e.map(function(e){return Object.assign({eventType:n},e)})}function _(n,t,e){return e.map(function(e){return Object.assign({eventType:n,eventSubtype:t},e)})}Object.keys||(Object.keys=(g=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),k=(y=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("function"!=typeof e&&("object"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var n,t,i=[];for(n in e)g.call(e,n)&&i.push(n);if(b)for(t=0;t<k;t++)g.call(e,y[t])&&i.push(y[t]);return i})),n();function j(e){e=e.requestFn,this._endpointOrigin="https://insights.algolia.io",this._anonymousUserToken=!0,this._userHasOptedOut=!1,this._useCookie=!1,this._cookieDuration=6*p,this._ua=[],this.version=a,this.sendEvents=i(e).bind(this),this.init=m.bind(this),this.addAlgoliaAgent=function(e){-1===this._ua.indexOf(e)&&this._ua.push(e)}.bind(this),this.setUserToken=function(e){return this._userToken=e,r(this._onUserTokenChangeCallback)&&this._onUserTokenChangeCallback(this._userToken),this._userToken}.bind(this),this.setAnonymousUserToken=function(e){(e=void 0!==e&&e)?this.setUserToken("anonymous-"+c()):t()&&((e=h(v))&&""!==e&&0===e.indexOf("anonymous-")?this.setUserToken(e):(e=this.setUserToken("anonymous-"+c()),l(v,e,this._cookieDuration)))}.bind(this),this.getUserToken=function(e,n){return r(n)&&n(null,this._userToken),this._userToken}.bind(this),this.onUserTokenChange=function(e,n){this._onUserTokenChangeCallback=e,n&&n.immediate&&r(this._onUserTokenChangeCallback)&&this._onUserTokenChangeCallback(this._userToken)}.bind(this),this.clickedObjectIDsAfterSearch=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("click",t),i)}.bind(this),this.clickedObjectIDs=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("click",t),i)}.bind(this),this.clickedFilters=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("click",t),i)}.bind(this),this.convertedObjectIDsAfterSearch=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("conversion",t),i)}.bind(this),this.purchasedObjectIDsAfterSearch=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(_("conversion","purchase",t),i)}.bind(this),this.addedToCartObjectIDsAfterSearch=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(_("conversion","addToCart",t),i)}.bind(this),this.convertedObjectIDs=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("conversion",t),i)}.bind(this),this.addedToCartObjectIDs=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(_("conversion","addToCart",t),i)}.bind(this),this.purchasedObjectIDs=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(_("conversion","purchase",t),i)}.bind(this),this.convertedFilters=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("conversion",t),i)}.bind(this),this.viewedObjectIDs=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("view",t),i)}.bind(this),this.viewedFilters=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t=(i=o(e)).events,i=i.additionalParams;return this.sendEvents(T("view",t),i)}.bind(this),this.getVersion=function(e){r(e)&&e(this.version)}.bind(this)}function x(e,n){var t=JSON.stringify(n),t=navigator.sendBeacon(e,t);return Promise.resolve(!!t||A(e,n))}var A=function(o,r){return new Promise(function(e,n){var t=JSON.stringify(r),i=new XMLHttpRequest;i.addEventListener("readystatechange",function(){4===i.readyState&&200===i.status?e(!0):4===i.readyState&&e(!1)}),i.addEventListener("error",function(){return n()}),i.addEventListener("timeout",function(){return e(!1)}),i.open("POST",o),i.setRequestHeader("Content-Type","application/json"),i.setRequestHeader("Content-Length",""+t.length),i.send(t)})};function w(e){var t,i,n=e.AlgoliaAnalyticsObject;n&&(i=this,t=function(e){for(var n=[],t=arguments.length-1;0<t--;)n[t]=arguments[t+1];e&&r(i[e])?i[e].apply(i,n):console.warn("The method `"+e+"` doesn't exist.")},(e=e[n]).queue=e.queue||[],(n=e.queue).forEach(function(e){var e=[].slice.call(e),n=e[0],e=e.slice(1);t.apply(void 0,[n].concat(e))}),n.push=function(e){var e=[].slice.call(e),n=e[0],e=e.slice(1);t.apply(void 0,[n].concat(e))})}function P(e){e=new j({requestFn:e});return"object"==typeof window&&w.call(e,window),e.version=a,e}var C=P(function(){if(function(){try{return Boolean(navigator.sendBeacon)}catch(e){return!1}}())return x;if(function(){try{return Boolean(XMLHttpRequest)}catch(e){return!1}}())return A;throw new Error("Could not find a supported HTTP request client in this environment.")}());e.createInsightsClient=P,e.default=C,Object.defineProperty(e,"__esModule",{value:!0})});
